<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Mini Map Testtt</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <style>
    #map { width: 100%;     height: 235px !important;
    min-height: 235px !important;
    overflow: hidden;}
    html,body { height:100%; margin:0; padding:0; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- MaplibreGL ve leaflet-maplibre-gl artık kullanılmayacak, yorumda bırak -->
  <!--
  <script src="https://unpkg.com/maplibre-gl@3.5.2/dist/maplibre-gl.js"></script>
  <script src="https://unpkg.com/@maplibre/maplibre-gl-leaflet@0.1.3/leaflet-maplibre-gl.js"></script>
  -->
  <script>
    function getParam(name) {
      try {
        const url = new URL(window.location.href);
        return url.searchParams.get(name);
      } catch {
        return null;
      }
    }
    const lat = parseFloat(getParam("lat")) || 41.01;
    const lon = parseFloat(getParam("lon")) || 29.00;
    const zoom = 14;

    const map = L.map('map').setView([lat, lon], zoom);

    // --- OpenFreeMap / MaplibreGL katmanı YORUMDA ---
    /*
    fetch('https://tiles.openfreemap.org/styles/bright')
      .then(res => {
        if (!res.ok) throw new Error('Style JSON fetch failed ' + res.status);
        return res.json();
      })
      .then(style => {
        Object.entries(style.sources).forEach(([src, obj]) => {
          if (src === 'openmaptiles' || obj.type === 'vector') {
            obj.tiles = ['https://dev.triptime.ai/api/tile/{z}/{x}/{y}.pbf'];
            delete obj.url;
          }
          if (Array.isArray(obj.tiles) && obj.type === 'raster') {
            obj.tiles = ['https://dev.triptime.ai/api/tile/{z}/{x}/{y}.png'];
          }
        });
        const maplibreLayer = L.maplibreGL({ style });
        maplibreLayer.addTo(map);
      })
      .catch(err => {
        console.error('[PROXY ERROR] Style veya Tile Proxy hatası:', err);
      });
    */

    // --- SADECE OSM TILE KULLAN ---
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    L.marker([lat, lon]).addTo(map);
  </script>
</body>
</html>